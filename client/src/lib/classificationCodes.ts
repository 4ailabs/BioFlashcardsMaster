// Códigos de clasificación para las diferentes categorías de patógenos
export const classificationCodes = {
  bacterias: {
    "Estafilococo dorado": "A1",
    "Estafilococo albus": "A2",
    "Neumococo": "A3",
    "Streptococo Beta hemolítico": "A4",
    "Estreptococo fragilis": "A5",
    "Estreptococo faecalis": "A6",
    "Estreptococo alfa": "A7",
    "Estreptococo G": "A8",
    "Estreptococo C": "A9",
    "Estreptococo B agalactie": "A10",
    "Bacilo antráx": "A11",
    "Bacilo de Klebs-löffler": "A12",
    "Listeria": "A13",
    "Neisseria catarrhalis": "A14",
    "Gonococo": "A15",
    "Meningococo": "A16",
    "Campylobacter": "A17",
    "Enterobacter cloacae": "A18",
    "Escherichia Coli": "A19",
    "Helicobacter Pylori": "A20",
    "Klebsiella": "A21",
    "Proteus": "A22",
    "Salmonella": "A23",
    "Shigella": "A24",
    "Vibrio Cholerae": "A25",
    "Yersinia": "A26",
    "Bacilo de la Tos ferina": "A27",
    "Pseudomona aeruginosa": "A28",
    "Haemophilus influenzae": "A29",
    "Pasteurella": "A30",
    "Brucella": "A31",
    "Coxiella": "A32",
    "Clamidia": "A33",
    "Borrelia": "A34",
    "Leptospira": "A35",
    "Treponema pallidum": "A36",
    "Ricketisia": "A37",
    "Legionella": "A38",
    "Micoplasma": "A39",
    "Bacilo de la Tuberculosis": "A40",
    "Bacilo de la Lepra": "A41",
    "Gardenerella": "A42",
    "Clostridium tetani": "A43",
    "Clostridium malignun": "A44",
    "Clostridium perfringes": "A45",
    "Clostridium leptum": "A46",
    "Clostridium histolyticum": "A47",
    "Fusobacterium": "A48",
    "Prevotella": "A49",
    "Tifo exantemático": "A50",
    "Morganella tifo": "A51",
    "Veionella": "A52"
  },
  virus_adn: {
    "Virus de la viruela": "B1",
    "Vaccinia": "B2",
    "Virus Orf": "B3",
    "Herpes simple tipo 1": "B4",
    "Herpes simple tipo 2": "B5",
    "Virus de la varicela zoster": "B6",
    "Citomegalovirus humano": "B7",
    "Herpesvirus humano tipo 6": "B8",
    "Herpesvirus humano tipo 7": "B9",
    "Virus Epstein-Barr": "B10",
    "Herpesvirus humano tipo 8": "B11",
    "Adenovirus": "B12",
    "Virus del Papiloma": "B13",
    "Virus de la verruga común": "B14",
    "Virus JC": "B15",
    "Virus BK": "B16",
    "Virus de la hepatitis B": "B17",
    "Parvovirus B19": "B18"
  },
  virus_arn: {
    "Virus de la rabia": "B19",
    "Influenza": "B20",
    "Virus de la Aftosa": "B21",
    "Rubéola": "B22",
    "VIH 1": "B23",
    "Pleuritis viral": "B24",
    "Sarampión": "B25",
    "Catarro común": "B26",
    "Virus del Nilo": "B27",
    "Virus del dengue": "B28",
    "Virus de la encefalitis": "B29",
    "Sinusitis viral": "B30",
    "Rotavirus": "B31",
    "Virus Newcastle": "B32",
    "Virus Guiliam barre": "B33",
    "Virus del dengue hemorrágico": "B34",
    "Enterovirus": "B35",
    "Meningitis viral": "B36",
    "Coronavirus": "B37",
    "HTLV 1": "B38",
    "Virus Norwalk": "B39",
    "HTLV 2": "B40",
    "Virus de la parotiditis": "B41",
    "Virus de la polio": "B42",
    "HTLV 4": "B43",
    "VIH 2": "B44",
    "Virus del Ebola": "B45",
    "Virus Zika": "B46",
    "Hanta virus": "B47",
    "Virus H1N7": "B48",
    "Virus Chikunguña": "B49"
  },
  parasito: {
    "Toxoplasma gondii": "C1",
    "Plasmodium": "C2",
    "Entamoeba histolytica": "C3",
    "Sarcoptes scabiei": "C4",
    "Filaria": "C5",
    "Blastocystis hominis": "C6",
    "Balantidium Coli": "C7",
    "Trypanosoma Cruzi": "C8",
    "Fasciolopsis Buski": "C9",
    "Enterobius vermicularis": "C10",
    "Trichinella spiralis": "C11",
    "Trichomonas": "C12",
    "Schistosoma": "C13",
    "Parásitos intestinales": "C14",
    "Babesia": "C15",
    "Trypanosoma Gambiense": "C16",
    "Onchocerca volvulus": "C17",
    "Leishmania": "C18",
    "Giardia lamblia": "C19"
  },
  parasitos: {
    "Toxoplasma gondii": "C1",
    "Plasmodium": "C2",
    "Entamoeba histolytica": "C3",
    "Sarcoptes scabiei": "C4",
    "Filaria": "C5",
    "Blastocystis hominis": "C6",
    "Balantidium Coli": "C7",
    "Trypanosoma Cruzi": "C8",
    "Fasciolopsis Buski": "C9",
    "Enterobius vermicularis": "C10",
    "Trichinella spiralis": "C11",
    "Trichomonas": "C12",
    "Schistosoma": "C13",
    "Parásitos intestinales": "C14",
    "Babesia": "C15",
    "Trypanosoma Gambiense": "C16",
    "Onchocerca volvulus": "C17",
    "Leishmania": "C18",
    "Giardia lamblia": "C19"
  },
  hongo: {
    "Aspergillus": "D1",
    "Cryptococcus neoformans": "D2",
    "Coccidioides immitis": "D3",
    "Histoplasma capsulatum": "D4",
    "Candida albicans": "D5",
    "Trichophyton": "D6",
    "Pneumocystis carinii": "D7",
    "Actinomyces": "D8",
    "Micelio intestinal": "D9",
    "Microsporum canis": "D10",
    "Malassezia furfur": "D11"
  },
  hongos: {
    "Aspergillus": "D1",
    "Cryptococcus neoformans": "D2",
    "Coccidioides immitis": "D3",
    "Histoplasma capsulatum": "D4",
    "Candida albicans": "D5",
    "Trichophyton": "D6",
    "Pneumocystis carinii": "D7",
    "Actinomyces": "D8",
    "Micelio intestinal": "D9",
    "Microsporum canis": "D10",
    "Malassezia furfur": "D11"
  }
};

// Función para buscar el código de clasificación basado en el nombre del patógeno
export function findClassificationCode(name: string, category: string): string | undefined {
  // Normalizar el nombre para buscar coincidencias parciales
  const normalizedName = name.toLowerCase().trim();
  
  // Categorías alternativas para buscar coincidencias
  let categoriesToTry: string[] = [category];
  
  // Mapa de categorías alternativas para buscar
  const categoryAlternatives: Record<string, string[]> = {
    'parasito': ['parasitos'],
    'parasitos': ['parasito'],
    'hongo': ['hongos'],
    'hongos': ['hongo']
  };
  
  // Añadir categorías alternativas si existen
  if (categoryAlternatives[category]) {
    categoriesToTry = [...categoriesToTry, ...categoryAlternatives[category]];
  }
  
  // Probar todas las categorías posibles
  for (const cat of categoriesToTry) {
    // Obtener los códigos para la categoría específica
    const categoryCodes = classificationCodes[cat as keyof typeof classificationCodes];
    
    if (!categoryCodes) continue;
    
    // Buscar coincidencias exactas o parciales
    for (const [patogenName, code] of Object.entries(categoryCodes)) {
      if (normalizedName === patogenName.toLowerCase() || 
          normalizedName.includes(patogenName.toLowerCase()) || 
          patogenName.toLowerCase().includes(normalizedName)) {
        return code;
      }
    }
  }
  
  // Si no se encontró en ninguna categoría, buscar en todas
  if (!categoriesToTry.includes('all')) {
    for (const [cat, codes] of Object.entries(classificationCodes)) {
      // Saltar categorías ya verificadas
      if (categoriesToTry.includes(cat)) continue;
      
      for (const [patogenName, code] of Object.entries(codes)) {
        // Buscar coincidencias muy específicas (para evitar falsos positivos)
        if (normalizedName === patogenName.toLowerCase() || 
            (normalizedName.length > 5 && patogenName.toLowerCase().includes(normalizedName))) {
          console.log(`Encontrado código ${code} para ${name} en categoría alternativa ${cat}`);
          return code;
        }
      }
    }
  }
  
  return undefined;
}